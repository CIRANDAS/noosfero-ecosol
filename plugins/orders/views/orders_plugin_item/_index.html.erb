<% partial = @admin_action ? 'admin_edit' : 'edit' %>

<div class="order-items-container <%= "empty" if order.items.count == 0 %>">
  <% if order.items.count > 0 %>
    <div class="order-items">
      <div class="table-header">
        <div class="box-field supplier"> <%= t('orders_plugin.views.item._index.supplier') %> </div>
        <div class="box-field product"> <%= t('orders_plugin.views.item._index.product') %> </div>
        <div class="box-field quantity"> <%= t('orders_plugin.views.item._index.quantity') %> </div>
        <div class="box-field price-total"> <%= t('orders_plugin.views.item._index.price_total') % {:currency => @environment.currency_unit} %> </div>
        <% if @admin_action %>
          <div class="box-field status-updated"> <%= t('orders_plugin.views.item._index.status_updated') %> </div>
        <% end %>
      </div>

      <div class="table-content">
        <% if f %>
          <% f.fields_for :items, order.items do |f| %>
            <% order.items.each do |item| %>
              <%= render "orders_plugin_item/#{partial}", :order => order, :item => item, :product => item.product, :f => f %>
            <% end %>
          <% end %>
        <% else %>
          <% order.items.each do |item| %>
            <%= render "orders_plugin_item/#{partial}", :order => order, :item => item, :product => item.product, :f => f %>
          <% end %>
        <% end %>
      </div>

      <div class="clean"></div>
    </div>

    <div id="order-total-<%=order.id%>" class="order-total">
      <%= render :partial => 'orders_plugin_consumer/total', :locals => {:order => order} %>
    </div>
  <% else %>
    <%= t('orders_plugin.views.item._index.empty_order') %>
  <% end %>

  <div class="clean"></div>
</div>

